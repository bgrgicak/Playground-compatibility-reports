file:///home/runner/work/playground-tester/playground-tester/node_modules/@wp-playground/cli/index.js:237
        throw new Error(y, { cause: u });
              ^

Error: [20-May-2025 15:51:19 UTC] PHP Notice:  Function _load_textdomain_just_in_time was called <strong>incorrectly</strong>. Translation loading for the <code>myshopkit-popup-smartbar-slidein</code> domain was triggered too early. This is usually an indicator for some code in the plugin or theme running too early. Translations should be loaded at the <code>init</code> action or later. Please see <a href="https://developer.wordpress.org/advanced-administration/debug/debug-wordpress/">Debugging in WordPress</a> for more information. (This message was added in version 6.7.0.) in /wordpress/wp-includes/functions.php on line 6121
[20-May-2025 15:51:19 UTC] PHP Warning:  Undefined array key "REMOTE_ADDR" in /wordpress/wp-content/plugins/myshopkit-popup-smartbar-slidein/src/Dashboard/Shared/TraitSSLDetector.php on line 18
[20-May-2025 15:51:32 UTC] PHP Notice:  Function _load_textdomain_just_in_time was called <strong>incorrectly</strong>. Translation loading for the <code>myshopkit-popup-smartbar-slidein</code> domain was triggered too early. This is usually an indicator for some code in the plugin or theme running too early. Translations should be loaded at the <code>init</code> action or later. Please see <a href="https://developer.wordpress.org/advanced-administration/debug/debug-wordpress/">Debugging in WordPress</a> for more information. (This message was added in version 6.7.0.) in /wordpress/wp-includes/functions.php on line 6121
[20-May-2025 15:51:32 UTC] PHP Warning:  Undefined array key "REMOTE_ADDR" in /wordpress/wp-content/plugins/myshopkit-popup-smartbar-slidein/src/Dashboard/Shared/TraitSSLDetector.php on line 18
[20-May-2025 15:51:47 UTC] PHP Notice:  Function _load_textdomain_just_in_time was called <strong>incorrectly</strong>. Translation loading for the <code>myshopkit-popup-smartbar-slidein</code> domain was triggered too early. This is usually an indicator for some code in the plugin or theme running too early. Translations should be loaded at the <code>init</code> action or later. Please see <a href="https://developer.wordpress.org/advanced-administration/debug/debug-wordpress/">Debugging in WordPress</a> for more information. (This message was added in version 6.7.0.) in /wordpress/wp-includes/functions.php on line 6121
[20-May-2025 15:51:48 UTC] PHP Warning:  Undefined array key "REMOTE_ADDR" in /wordpress/wp-content/plugins/myshopkit-popup-smartbar-slidein/src/Dashboard/Shared/TraitSSLDetector.php on line 18
[20-May-2025 15:52:57 UTC] PHP Fatal error:  Uncaught ArgumentCountError: Too few arguments to function WP_Widget::__construct(), 0 passed in /wordpress/wp-includes/class-wp-widget-factory.php on line 62 and at least 2 expected in /wordpress/wp-includes/class-wp-widget.php:163
Stack trace:
#0 /wordpress/wp-includes/class-wp-widget-factory.php(62): WP_Widget->__construct()
#1 /wordpress/wp-includes/widgets.php(123): WP_Widget_Factory->register('Mloovi_Widget')
#2 /wordpress/wp-content/plugins/mloovi-translate-widget/mloovi.php(28): register_widget('Mloovi_Widget')
#3 /wordpress/wp-includes/class-wp-hook.php(324): mloovi_load_widgets('')
#4 /wordpress/wp-includes/class-wp-hook.php(348): WP_Hook->apply_filters(NULL, Array)
#5 /wordpress/wp-includes/plugin.php(517): WP_Hook->do_action(Array)
#6 /wordpress/wp-includes/widgets.php(1870): do_action('widgets_init')
#7 /wordpress/wp-includes/class-wp-hook.php(324): wp_widgets_init('')
#8 /wordpress/wp-includes/class-wp-hook.php(348): WP_Hook->apply_filters(NULL, Array)
#9 /wordpress/wp-includes/plugin.php(517): WP_Hook->do_action(Array)
#10 /wordpress/wp-settings.php(727): do_action('init')
#11 /wordpress/wp-config.php(102): require_once('/wordpress/wp-s...')
#12 /wordpress/wp-load.php(50): require_once('/wordpress/wp-c...')
#13 /internal/eval.php(3): require_once('/wordpress/wp-l...')
#14 {main}
  thrown in /wordpress/wp-includes/class-wp-widget.php on line 163
[20-May-2025 15:53:05 UTC] PHP Fatal error:  Uncaught ArgumentCountError: Too few arguments to function WP_Widget::__construct(), 0 passed in /wordpress/wp-includes/class-wp-widget-factory.php on line 62 and at least 2 expected in /wordpress/wp-includes/class-wp-widget.php:163
Stack trace:
#0 /wordpress/wp-includes/class-wp-widget-factory.php(62): WP_Widget->__construct()
#1 /wordpress/wp-includes/widgets.php(123): WP_Widget_Factory->register('Mloovi_Widget')
#2 /wordpress/wp-content/plugins/mloovi-translate-widget/mloovi.php(28): register_widget('Mloovi_Widget')
#3 /wordpress/wp-includes/class-wp-hook.php(324): mloovi_load_widgets('')
#4 /wordpress/wp-includes/class-wp-hook.php(348): WP_Hook->apply_filters(NULL, Array)
#5 /wordpress/wp-includes/plugin.php(517): WP_Hook->do_action(Array)
#6 /wordpress/wp-includes/widgets.php(1870): do_action('widgets_init')
#7 /wordpress/wp-includes/class-wp-hook.php(324): wp_widgets_init('')
#8 /wordpress/wp-includes/class-wp-hook.php(348): WP_Hook->apply_filters(NULL, Array)
#9 /wordpress/wp-includes/plugin.php(517): WP_Hook->do_action(Array)
#10 /wordpress/wp-settings.php(727): do_action('init')
#11 /wordpress/wp-config.php(102): require_once('/wordpress/wp-s...')
#12 /wordpress/wp-load.php(50): require_once('/wordpress/wp-c...')
#13 /internal/eval.php(3): require_once('/wordpress/wp-l...')
#14 {main}
  thrown in /wordpress/wp-includes/class-wp-widget.php on line 163
[20-May-2025 15:53:14 UTC] PHP Fatal error:  Uncaught ArgumentCountError: Too few arguments to function WP_Widget::__construct(), 0 passed in /wordpress/wp-includes/class-wp-widget-factory.php on line 62 and at least 2 expected in /wordpress/wp-includes/class-wp-widget.php:163
Stack trace:
#0 /wordpress/wp-includes/class-wp-widget-factory.php(62): WP_Widget->__construct()
#1 /wordpress/wp-includes/widgets.php(123): WP_Widget_Factory->register('Mloovi_Widget')
#2 /wordpress/wp-content/plugins/mloovi-translate-widget/mloovi.php(28): register_widget('Mloovi_Widget')
#3 /wordpress/wp-includes/class-wp-hook.php(324): mloovi_load_widgets('')
#4 /wordpress/wp-includes/class-wp-hook.php(348): WP_Hook->apply_filters(NULL, Array)
#5 /wordpress/wp-includes/plugin.php(517): WP_Hook->do_action(Array)
#6 /wordpress/wp-includes/widgets.php(1870): do_action('widgets_init')
#7 /wordpress/wp-includes/class-wp-hook.php(324): wp_widgets_init('')
#8 /wordpress/wp-includes/class-wp-hook.php(348): WP_Hook->apply_filters(NULL, Array)
#9 /wordpress/wp-includes/plugin.php(517): WP_Hook->do_action(Array)
#10 /wordpress/wp-settings.php(727): do_action('init')
#11 /wordpress/wp-config.php(102): require_once('/wordpress/wp-s...')
#12 /wordpress/wp-load.php(50): require_once('/wordpress/wp-c...')
#13 /internal/eval.php(3): require_once('/wordpress/wp-l...')
#14 {main}
  thrown in /wordpress/wp-includes/class-wp-widget.php on line 163
[20-May-2025 15:54:05 UTC] PHP Notice:  Function wp_register_style was called <strong>incorrectly</strong>. Scripts and styles should not be registered or enqueued until the <code>wp_enqueue_scripts</code>, <code>admin_enqueue_scripts</code>, or <code>login_enqueue_scripts</code> hooks. This notice was triggered by the <code>ms4wp-block-style</code> handle. Please see <a href="https://developer.wordpress.org/advanced-administration/debug/debug-wordpress/">Debugging in WordPress</a> for more information. (This message was added in version 3.3.0.) in /wordpress/wp-includes/functions.php on line 6121
[20-May-2025 15:54:05 UTC] PHP Notice:  Function is_feed was called <strong>incorrectly</strong>. Conditional query tags do not work before the query is run. Before then, they always return false. Please see <a href="https://developer.wordpress.org/advanced-administration/debug/debug-wordpress/">Debugging in WordPress</a> for more information. (This message was added in version 3.1.0.) in /wordpress/wp-includes/functions.php on line 6121
[20-May-2025 15:54:05 UTC] PHP Notice:  Function wp_register_script was called <strong>incorrectly</strong>. Scripts and styles should not be registered or enqueued until the <code>wp_enqueue_scripts</code>, <code>admin_enqueue_scripts</code>, or <code>login_enqueue_scripts</code> hooks. This notice was triggered by the <code>ms4wp-frontend-script</code> handle. Please see <a href="https://developer.wordpress.org/advanced-administration/debug/debug-wordpress/">Debugging in WordPress</a> for more information. (This message was added in version 3.3.0.) in /wordpress/wp-includes/functions.php on line 6121
[20-May-2025 15:54:05 UTC] PHP Notice:  Function wp_register_script was called <strong>incorrectly</strong>. Scripts and styles should not be registered or enqueued until the <code>wp_enqueue_scripts</code>, <code>admin_enqueue_scripts</code>, or <code>login_enqueue_scripts</code> hooks. This notice was triggered by the <code>ms4wp-dep-micromodal</code> handle. Please see <a href="https://developer.wordpress.org/advanced-administration/debug/debug-wordpress/">Debugging in WordPress</a> for more information. (This message was added in version 3.3.0.) in /wordpress/wp-includes/functions.php on line 6121
[20-May-2025 15:54:14 UTC] PHP Notice:  Function wp_register_style was called <strong>incorrectly</strong>. Scripts and styles should not be registered or enqueued until the <code>wp_enqueue_scripts</code>, <code>admin_enqueue_scripts</code>, or <code>login_enqueue_scripts</code> hooks. This notice was triggered by the <code>ms4wp-block-style</code> handle. Please see <a href="https://developer.wordpress.org/advanced-administration/debug/debug-wordpress/">Debugging in WordPress</a> for more information. (This message was added in version 3.3.0.) in /wordpress/wp-includes/functions.php on line 6121
[20-May-2025 15:54:14 UTC] PHP Notice:  Function is_feed was called <strong>incorrectly</strong>. Conditional query tags do not work before the query is run. Before then, they always return false. Please see <a href="https://developer.wordpress.org/advanced-administration/debug/debug-wordpress/">Debugging in WordPress</a> for more information. (This message was added in version 3.1.0.) in /wordpress/wp-includes/functions.php on line 6121
[20-May-2025 15:54:14 UTC] PHP Notice:  Function wp_register_script was called <strong>incorrectly</strong>. Scripts and styles should not be registered or enqueued until the <code>wp_enqueue_scripts</code>, <code>admin_enqueue_scripts</code>, or <code>login_enqueue_scripts</code> hooks. This notice was triggered by the <code>ms4wp-frontend-script</code> handle. Please see <a href="https://developer.wordpress.org/advanced-administration/debug/debug-wordpress/">Debugging in WordPress</a> for more information. (This message was added in version 3.3.0.) in /wordpress/wp-includes/functions.php on line 6121
[20-May-2025 15:54:14 UTC] PHP Notice:  Function wp_register_script was called <strong>incorrectly</strong>. Scripts and styles should not be registered or enqueued until the <code>wp_enqueue_scripts</code>, <code>admin_enqueue_scripts</code>, or <code>login_enqueue_scripts</code> hooks. This notice was triggered by the <code>ms4wp-dep-micromodal</code> handle. Please see <a href="https://developer.wordpress.org/advanced-administration/debug/debug-wordpress/">Debugging in WordPress</a> for more information. (This message was added in version 3.3.0.) in /wordpress/wp-includes/functions.php on line 6121
[20-May-2025 15:54:23 UTC] PHP Notice:  Function wp_register_style was called <strong>incorrectly</strong>. Scripts and styles should not be registered or enqueued until the <code>wp_enqueue_scripts</code>, <code>admin_enqueue_scripts</code>, or <code>login_enqueue_scripts</code> hooks. This notice was triggered by the <code>ms4wp-block-style</code> handle. Please see <a href="https://developer.wordpress.org/advanced-administration/debug/debug-wordpress/">Debugging in WordPress</a> for more information. (This message was added in version 3.3.0.) in /wordpress/wp-includes/functions.php on line 6121
[20-May-2025 15:54:23 UTC] PHP Notice:  Function is_feed was called <strong>incorrectly</strong>. Conditional query tags do not work before the query is run. Before then, they always return false. Please see <a href="https://developer.wordpress.org/advanced-administration/debug/debug-wordpress/">Debugging in WordPress</a> for more information. (This message was added in version 3.1.0.) in /wordpress/wp-includes/functions.php on line 6121
[20-May-2025 15:54:23 UTC] PHP Notice:  Function wp_register_script was called <strong>incorrectly</strong>. Scripts and styles should not be registered or enqueued until the <code>wp_enqueue_scripts</code>, <code>admin_enqueue_scripts</code>, or <code>login_enqueue_scripts</code> hooks. This notice was triggered by the <code>ms4wp-frontend-script</code> handle. Please see <a href="https://developer.wordpress.org/advanced-administration/debug/debug-wordpress/">Debugging in WordPress</a> for more information. (This message was added in version 3.3.0.) in /wordpress/wp-includes/functions.php on line 6121
[20-May-2025 15:54:23 UTC] PHP Notice:  Function wp_register_script was called <strong>incorrectly</strong>. Scripts and styles should not be registered or enqueued until the <code>wp_enqueue_scripts</code>, <code>admin_enqueue_scripts</code>, or <code>login_enqueue_scripts</code> hooks. This notice was triggered by the <code>ms4wp-dep-micromodal</code> handle. Please see <a href="https://developer.wordpress.org/advanced-administration/debug/debug-wordpress/">Debugging in WordPress</a> for more information. (This message was added in version 3.3.0.) in /wordpress/wp-includes/functions.php on line 6121
[20-May-2025 15:54:59 UTC] PHP Notice:  Function WP_Scripts::localize was called <strong>incorrectly</strong>. The <code>$l10n</code> parameter must be an array. To pass arbitrary data to scripts, use the <code>wp_add_inline_script()</code> function instead. Please see <a href="https://developer.wordpress.org/advanced-administration/debug/debug-wordpress/">Debugging in WordPress</a> for more information. (This message was added in version 5.7.0.) in /wordpress/wp-includes/functions.php on line 6121
[20-May-2025 15:55:06 UTC] PHP Notice:  Function WP_Scripts::localize was called <strong>incorrectly</strong>. The <code>$l10n</code> parameter must be an array. To pass arbitrary data to scripts, use the <code>wp_add_inline_script()</code> function instead. Please see <a href="https://developer.wordpress.org/advanced-administration/debug/debug-wordpress/">Debugging in WordPress</a> for more information. (This message was added in version 5.7.0.) in /wordpress/wp-includes/functions.php on line 6121
[20-May-2025 15:55:14 UTC] PHP Notice:  Function WP_Scripts::localize was called <strong>incorrectly</strong>. The <code>$l10n</code> parameter must be an array. To pass arbitrary data to scripts, use the <code>wp_add_inline_script()</code> function instead. Please see <a href="https://developer.wordpress.org/advanced-administration/debug/debug-wordpress/">Debugging in WordPress</a> for more information. (This message was added in version 5.7.0.) in /wordpress/wp-includes/functions.php on line 6121
[20-May-2025 15:56:57 UTC] PHP Fatal error:  Unparenthesized `a ? b : c ? d : e` is not supported. Use either `(a ? b : c) ? d : e` or `a ? b : (c ? d : e)` in /wordpress/wp-content/plugins/main-category-as-subdomain/class.subdomain.php on line 629
[20-May-2025 15:57:05 UTC] PHP Fatal error:  Unparenthesized `a ? b : c ? d : e` is not supported. Use either `(a ? b : c) ? d : e` or `a ? b : (c ? d : e)` in /wordpress/wp-content/plugins/main-category-as-subdomain/class.subdomain.php on line 629
[20-May-2025 15:57:12 UTC] PHP Fatal error:  Unparenthesized `a ? b : c ? d : e` is not supported. Use either `(a ? b : c) ? d : e` or `a ? b : (c ? d : e)` in /wordpress/wp-content/plugins/main-category-as-subdomain/class.subdomain.php on line 629
[20-May-2025 15:59:39 UTC] WordPress database error <div style="clear:both">&nbsp;</div>
<div class="queries" style="clear:both;margin-bottom:2px;border:red dotted thin;">
<p>MySQL query:</p>
<p> DROP PROCEDURE IF EXISTS wp_vsmp_compute_attribution;</p>
<p>Queries made or created this session were:</p>
<ol>
<li>Executing: BEGIN | (no parameters)</li>
<li>Executing: DROP PROCEDURE IF EXISTS `wp_vsmp_compute_attribution` | (no parameters)</li>
<li>Executing: ROLLBACK | (no parameters)</li>
</ol>
</div>
<div style="clear:both;margin-bottom:2px;border:red dotted thin;" class="error_message" style="border-bottom:dotted blue thin;">
SQLSTATE[HY000]: General error: 1 near "PROCEDURE": syntax error
</div>
<p>Backtrace:</p>
<pre>#0 /internal/shared/sqlite-database-integration/wp-includes/sqlite-ast/class-wp-sqlite-driver.php(683): WP_SQLite_Driver->new_driver_exception('SQLSTATE[HY000]...', 'HY000', Object(PDOException))
#1 /internal/shared/sqlite-database-integration/wp-includes/sqlite/class-wp-sqlite-db.php(491): WP_SQLite_Driver->query(' DROP PROCEDURE...')
#2 /internal/shared/sqlite-database-integration/wp-includes/sqlite/class-wp-sqlite-db.php(432): WP_SQLite_DB->_do_query(' DROP PROCEDURE...')
#3 /wordpress/wp-content/plugins/marketing-performance/activate/vsmp-run_ddl.php(42): WP_SQLite_DB->query(' DROP PROCEDURE...')
#4 /wordpress/wp-content/plugins/marketing-performance/marketing-performance.php(298): vsmp_run_ddl('vsmp-install.sq...')
#5 /wordpress/wp-includes/class-wp-hook.php(324): vsmp_attribution_activate(false)
#6 /wordpress/wp-includes/class-wp-hook.php(348): WP_Hook->apply_filters('', Array)
#7 /wordpress/wp-includes/plugin.php(517): WP_Hook->do_action(Array)
#8 /wordpress/wp-admin/includes/plugin.php(703): do_action('activate_market...', false)
#9 /internal/eval.php(20): activate_plugin('marketing-perfo...')
#10 {main}</pre>
 for query  DROP PROCEDURE IF EXISTS wp_vsmp_compute_attribution; made by activate_plugin, do_action('activate_marketing-performance/marketing-performance.php'), WP_Hook->do_action, WP_Hook->apply_filters, vsmp_attribution_activate, vsmp_run_ddl, WP_SQLite_DB->query, WP_SQLite_DB->print_error
[20-May-2025 15:59:40 UTC] WordPress database error <div style="clear:both">&nbsp;</div>
<div class="queries" style="clear:both;margin-bottom:2px;border:red dotted thin;">
<p>MySQL query:</p>
<p> CREATE PROCEDURE wp_vsmp_compute_attribution (IN `table_prefix` VARCHAR(16)) BEGIN DROP TABLE IF EXISTS tmp_date_range; DROP TABLE IF EXISTS tmp_conversion_log; DROP TABLE IF EXISTS tmp_influence; DROP TABLE IF EXISTS tmp_adj_influence; DROP TABLE IF EXISTS tmp_attribution; CREATE TABLE tmp_date_range AS (      SELECT DATE_SUB(CURRENT_DATE, INTERVAL 28 DAY) AS from_date, CURRENT_DATE AS to_date ); SET @stmt1 = CONCAT(     "CREATE TABLE tmp_conversion_log AS ("     , " SELECT *"     , " FROM ", table_prefix, "vsmp_conversion_log"     , " WHERE DATE(log_time) BETWEEN"     , " (SELECT from_date FROM tmp_date_range)"     , " AND"     , " (SELECT to_date FROM tmp_date_range)"  	, ")" );      PREPARE vsmp_sql FROM @stmt1; EXECUTE vsmp_sql; DEALLOCATE PREPARE vsmp_sql; SET @stmt2 = CONCAT( 	"CREATE TABLE tmp_influence AS (" 	, " SELECT a.conversion_id, a.delivery_event_id, MAX(influence) AS influence" 	, " FROM ", table_prefix, "vsmp_influence a" 	, " WHERE a.conversion_id IN (" 	, " SELECT conversion_id" 	, " FROM tmp_conversion_log" 	, " )"     , " GROUP BY a.conversion_id, a.delivery_event_id"     , ")" ); PREPARE vsmp_sql FROM @stmt2; EXECUTE vsmp_sql; DEALLOCATE PREPARE vsmp_sql; SET @stmt3 = CONCAT( 	"CREATE TABLE tmp_adj_influence AS (" 	, " SELECT a.conversion_id, a.delivery_event_id," 	, " (a.influence * (CASE WHEN sum_influence > 1 THEN 1 / sum_influence ELSE 1 END)) / 1 AS adj_influence" 	, " FROM tmp_influence a" 	, " JOIN (" 	, " SELECT conversion_id, SUM(influence) AS sum_influence" 	, " FROM tmp_influence" 	, " GROUP BY conversion_id" 	, " ) b ON b.conversion_id = a.conversion_id"     , ")" ); PREPARE vsmp_sql FROM @stmt3; EXECUTE vsmp_sql; DEALLOCATE PREPARE vsmp_sql; SET @stmt4 = CONCAT( 	"CREATE TABLE tmp_attribution AS ("     , " SELECT DATE(b.log_time) AS cal_date, a.delivery_event_id,"     , " SUM(a.adj_influence) AS attributed_conversions,"     , " SUM(a.adj_influence * b.conversion_val) AS attributed_value"     , " FROM tmp_adj_influence a" 	, " JOIN tmp_conversion_log b ON b.conversion_id = a.conversion_id"  	, " GROUP BY 1, 2" 	, " )" ); PREPARE vsmp_sql FROM @stmt4; EXECUTE vsmp_sql; DEALLOCATE PREPARE vsmp_sql; SET @stmt5 = CONCAT( 	"DELETE FROM ", table_prefix, "vsmp_attribution" 	, " WHERE cal_date BETWEEN"     , " (SELECT from_date FROM tmp_date_range)"      , " AND"     , " (SELECT to_date FROM tmp_date_range)"	 ); PREPARE vsmp_sql FROM @stmt5; EXECUTE vsmp_sql; DEALLOCATE PREPARE vsmp_sql; SET @stmt6 = CONCAT( 	"INSERT INTO ", table_prefix, "vsmp_attribution"     , " (cal_date, delivery_event_id, attributed_conversions, attributed_value)"     , " SELECT cal_date, delivery_event_id, attributed_conversions, attributed_value"     , " FROM tmp_attribution" ); PREPARE vsmp_sql FROM @stmt6; EXECUTE vsmp_sql; DEALLOCATE PREPARE vsmp_sql; SET @stmt7 = CONCAT( 	"INSERT INTO ", table_prefix, "vsmp_attribution" 	, " (cal_date, attributed_conversions, attributed_value)" 	, " SELECT a.conversion_date," 	, " a.conversion_count - IFNULL(b.attributed_conversions,0) AS unattributed_conversions," 	, " a.conversion_value - IFNULL(b.attributed_value,0) AS unattributed_value" 	, " FROM (" 	, " SELECT date(log_time) AS conversion_date,"     , " COUNT(*) AS conversion_count,"     , " SUM(conversion_val) AS conversion_value" 	, " FROM tmp_conversion_log" 	, " GROUP BY 1" 	, " ) a" 	, " LEFT JOIN (" 	, " SELECT cal_date,"     , " SUM(attributed_conversions) AS attributed_conversions,"     , " SUM(attributed_value) AS attributed_value" 	, " FROM tmp_attribution" 	, " GROUP BY cal_date" 	, ") b ON b.cal_date = a.conversion_date"     , " WHERE a.conversion_value - IFNULL(b.attributed_value,0) > .01" ); PREPARE vsmp_sql FROM @stmt7; EXECUTE vsmp_sql; DEALLOCATE PREPARE vsmp_sql; DROP TABLE IF EXISTS tmp_date_range; DROP TABLE IF EXISTS tmp_conversion_log; DROP TABLE IF EXISTS tmp_influence; DROP TABLE IF EXISTS tmp_adj_influence; DROP TABLE IF EXISTS tmp_attribution; END</p>
<p>Queries made or created this session were:</p>
<ol>
<li>Executing: BEGIN | (no parameters)</li>
<li>Executing: ROLLBACK | (no parameters)</li>
</ol>
</div>
<div style="clear:both;margin-bottom:2px;border:red dotted thin;" class="error_message" style="border-bottom:dotted blue thin;">
MySQL query not supported. Cause: statement type: "createStatement" > "createProcedure"
</div>
<p>Backtrace:</p>
<pre>#0 /internal/shared/sqlite-database-integration/wp-includes/sqlite-ast/class-wp-sqlite-driver.php(848): WP_SQLite_Driver->new_not_supported_exception('statement type:...')
#1 /internal/shared/sqlite-database-integration/wp-includes/sqlite-ast/class-wp-sqlite-driver.php(669): WP_SQLite_Driver->execute_mysql_query(Object(WP_Parser_Node))
#2 /internal/shared/sqlite-database-integration/wp-includes/sqlite/class-wp-sqlite-db.php(491): WP_SQLite_Driver->query(' CREATE PROCEDU...')
#3 /internal/shared/sqlite-database-integration/wp-includes/sqlite/class-wp-sqlite-db.php(432): WP_SQLite_DB->_do_query(' CREATE PROCEDU...')
#4 /wordpress/wp-content/plugins/marketing-performance/activate/vsmp-run_ddl.php(42): WP_SQLite_DB->query(' CREATE PROCEDU...')
#5 /wordpress/wp-content/plugins/marketing-performance/marketing-performance.php(298): vsmp_run_ddl('vsmp-install.sq...')
#6 /wordpress/wp-includes/class-wp-hook.php(324): vsmp_attribution_activate(false)
#7 /wordpress/wp-includes/class-wp-hook.php(348): WP_Hook->apply_filters('', Array)
#8 /wordpress/wp-includes/plugin.php(517): WP_Hook->do_action(Array)
#9 /wordpress/wp-admin/includes/plugin.php(703): do_action('activate_market...', false)
#10 /internal/eval.php(20): activate_plugin('marketing-perfo...')
#11 {main}</pre>
 for query  CREATE PROCEDURE wp_vsmp_compute_attribution (IN `table_prefix` VARCHAR(16)) BEGIN DROP TABLE IF EXISTS tmp_date_range; DROP TABLE IF EXISTS tmp_conversion_log; DROP TABLE IF EXISTS tmp_influence; DROP TABLE IF EXISTS tmp_adj_influence; DROP TABLE IF EXISTS tmp_attribution; CREATE TABLE tmp_date_range AS (      SELECT DATE_SUB(CURRENT_DATE, INTERVAL 28 DAY) AS from_date, CURRENT_DATE AS to_date ); SET @stmt1 = CONCAT(     "CREATE TABLE tmp_conversion_log AS ("     , " SELECT *"     , " FROM ", table_prefix, "vsmp_conversion_log"     , " WHERE DATE(log_time) BETWEEN"     , " (SELECT from_date FROM tmp_date_range)"     , " AND"     , " (SELECT to_date FROM tmp_date_range)"  	, ")" );      PREPARE vsmp_sql FROM @stmt1; EXECUTE vsmp_sql; DEALLOCATE PREPARE vsmp_sql; SET @stmt2 = CONCAT( 	"CREATE TABLE tmp_influence AS (" 	, " SELECT a.conversion_id, a.delivery_event_id, MAX(influence) AS influence" 	, " FROM ", table_prefix, "vsmp_influence a" 	, " WHERE a.conversion_id IN (" 	, " SELECT conversion_id" 	, " FROM tmp_conversion_log" 	, " )"     , " GROUP BY a.conversion_id, a.delivery_event_id"     , ")" ); PREPARE vsmp_sql FROM @stmt2; EXECUTE vsmp_sql; DEALLOCATE PREPARE vsmp_sql; SET @stmt3 = CONCAT( 	"CREATE TABLE tmp_adj_influence AS (" 	, " SELECT a.conversion_id, a.delivery_event_id," 	, " (a.influence * (CASE WHEN sum_influence > 1 THEN 1 / sum_influence ELSE 1 END)) / 1 AS adj_influence" 	, " FROM tmp_influence a" 	, " JOIN (" 	, " SELECT conversion_id, SUM(influence) AS sum_influence" 	, " FROM tmp_influence" 	, " GROUP BY conversion_id" 	, " ) b ON b.conversion_id = a.conversion_id"     , ")" ); PREPARE vsmp_sql FROM @stmt3; EXECUTE vsmp_sql; DEALLOCATE PREPARE vsmp_sql; SET @stmt4 = CONCAT( 	"CREATE TABLE tmp_attribution AS ("     , " SELECT DATE(b.log_time) AS cal_date, a.delivery_event_id,"     , " SUM(a.adj_influence) AS attributed_conversions,"     , " SUM(a.adj_influence * b.conversion_val) AS attributed_value"     , " FROM tmp_adj_influence a" 	, " JOIN tmp_conversion_log b ON b.conversion_id = a.conversion_id"  	, " GROUP BY 1, 2" 	, " )" ); PREPARE vsmp_sql FROM @stmt4; EXECUTE vsmp_sql; DEALLOCATE PREPARE vsmp_sql; SET @stmt5 = CONCAT( 	"DELETE FROM ", table_prefix, "vsmp_attribution" 	, " WHERE cal_date BETWEEN"     , " (SELECT from_date FROM tmp_date_range)"      , " AND"     , " (SELECT to_date FROM tmp_date_range)"	 ); PREPARE vsmp_sql FROM @stmt5; EXECUTE vsmp_sql; DEALLOCATE PREPARE vsmp_sql; SET @stmt6 = CONCAT( 	"INSERT INTO ", table_prefix, "vsmp_attribution"     , " (cal_date, delivery_event_id, attributed_conversions, attributed_value)"     , " SELECT cal_date, delivery_event_id, attributed_conversions, attributed_value"     , " FROM tmp_attribution" ); PREPARE vsmp_sql FROM @stmt6; EXECUTE vsmp_sql; DEALLOCATE PREPARE vsmp_sql; SET @stmt7 = CONCAT( 	"INSERT INTO ", table_prefix, "vsmp_attribution" 	, " (cal_date, attributed_conversions, attributed_value)" 	, " SELECT a.conversion_date," 	, " a.conversion_count - IFNULL(b.attributed_conversions,0) AS unattributed_conversions," 	, " a.conversion_value - IFNULL(b.attributed_value,0) AS unattributed_value" 	, " FROM (" 	, " SELECT date(log_time) AS conversion_date,"     , " COUNT(*) AS conversion_count,"     , " SUM(conversion_val) AS conversion_value" 	, " FROM tmp_conversion_log" 	, " GROUP BY 1" 	, " ) a" 	, " LEFT JOIN (" 	, " SELECT cal_date,"     , " SUM(attributed_conversions) AS attributed_conversions,"     , " SUM(attributed_value) AS attributed_value" 	, " FROM tmp_attribution" 	, " GROUP BY cal_date" 	, ") b ON b.cal_date = a.conversion_date"     , " WHERE a.conversion_value - IFNULL(b.attributed_value,0) > .01" ); PREPARE vsmp_sql FROM @stmt7; EXECUTE vsmp_sql; DEALLOCATE PREPARE vsmp_sql; DROP TABLE IF EXISTS tmp_date_range; DROP TABLE IF EXISTS tmp_conversion_log; DROP TABLE IF EXISTS tmp_influence; DROP TABLE IF EXISTS tmp_adj_influence; DROP TABLE IF EXISTS tmp_attribution; END made by activate_plugin, do_action('activate_marketing-performance/marketing-performance.php'), WP_Hook->do_action, WP_Hook->apply_filters, vsmp_attribution_activate, vsmp_run_ddl, WP_SQLite_DB->query, WP_SQLite_DB->print_error
[20-May-2025 15:59:40 UTC] WordPress database error <div style="clear:both">&nbsp;</div>
<div class="queries" style="clear:both;margin-bottom:2px;border:red dotted thin;">
<p>MySQL query:</p>
<p> DROP PROCEDURE IF EXISTS wp_vsmp_compute_influence;</p>
<p>Queries made or created this session were:</p>
<ol>
<li>Executing: BEGIN | (no parameters)</li>
<li>Executing: DROP PROCEDURE IF EXISTS `wp_vsmp_compute_influence` | (no parameters)</li>
<li>Executing: ROLLBACK | (no parameters)</li>
</ol>
</div>
<div style="clear:both;margin-bottom:2px;border:red dotted thin;" class="error_message" style="border-bottom:dotted blue thin;">
SQLSTATE[HY000]: General error: 1 near "PROCEDURE": syntax error
</div>
<p>Backtrace:</p>
<pre>#0 /internal/shared/sqlite-database-integration/wp-includes/sqlite-ast/class-wp-sqlite-driver.php(683): WP_SQLite_Driver->new_driver_exception('SQLSTATE[HY000]...', 'HY000', Object(PDOException))
#1 /internal/shared/sqlite-database-integration/wp-includes/sqlite/class-wp-sqlite-db.php(491): WP_SQLite_Driver->query(' DROP PROCEDURE...')
#2 /internal/shared/sqlite-database-integration/wp-includes/sqlite/class-wp-sqlite-db.php(432): WP_SQLite_DB->_do_query(' DROP PROCEDURE...')
#3 /wordpress/wp-content/plugins/marketing-performance/activate/vsmp-run_ddl.php(42): WP_SQLite_DB->query(' DROP PROCEDURE...')
#4 /wordpress/wp-content/plugins/marketing-performance/marketing-performance.php(298): vsmp_run_ddl('vsmp-install.sq...')
#5 /wordpress/wp-includes/class-wp-hook.php(324): vsmp_attribution_activate(false)
#6 /wordpress/wp-includes/class-wp-hook.php(348): WP_Hook->apply_filters('', Array)
#7 /wordpress/wp-includes/plugin.php(517): WP_Hook->do_action(Array)
#8 /wordpress/wp-admin/includes/plugin.php(703): do_action('activate_market...', false)
#9 /internal/eval.php(20): activate_plugin('marketing-perfo...')
#10 {main}</pre>
 for query  DROP PROCEDURE IF EXISTS wp_vsmp_compute_influence; made by activate_plugin, do_action('activate_marketing-performance/marketing-performance.php'), WP_Hook->do_action, WP_Hook->apply_filters, vsmp_attribution_activate, vsmp_run_ddl, WP_SQLite_DB->query, WP_SQLite_DB->print_error
[20-May-2025 15:59:40 UTC] WordPress database error <div style="clear:both">&nbsp;</div>
<div class="queries" style="clear:both;margin-bottom:2px;border:red dotted thin;">
<p>MySQL query:</p>
<p> CREATE PROCEDURE wp_vsmp_compute_influence (IN `table_prefix` VARCHAR(16)) BEGIN DROP TABLE IF EXISTS tmp_date_range; DROP TABLE IF EXISTS tmp_delivery_event; DROP TABLE IF EXISTS tmp_channel_lag; DROP TABLE IF EXISTS tmp_conversion_log; DROP TABLE IF EXISTS tmp_delivery_event_log; DROP TABLE IF EXISTS tmp_delivery_event_influence_01; DROP TABLE IF EXISTS tmp_delivery_event_influence_02; CREATE TABLE tmp_date_range AS (      SELECT DATE_SUB(CURRENT_DATE, INTERVAL 28 DAY) AS from_date, CURRENT_DATE AS to_date ); SET @stmt1 = CONCAT(     "CREATE TABLE tmp_delivery_event AS ("     , " SELECT a.ID AS delivery_event_Id,"     , " CONVERT(b.meta_value, INTEGER) AS campaign_id,"     , " CONVERT(c.meta_value, INTEGER) AS channel_Id"     , " FROM ", table_prefix, "posts a"     , " JOIN ", table_prefix, "postmeta b ON b.post_id = a.ID AND b.meta_key = 'campaign_id'"  	, " JOIN ", table_prefix, "postmeta c ON c.post_id = a.ID AND c.meta_key = 'channel_id'"     , " WHERE a.post_type = 'vsmp_delivery_event'"     , " AND a.post_status = 'publish'"     , ')' ); PREPARE vsmp_sql FROM @stmt1; EXECUTE vsmp_sql; DEALLOCATE PREPARE vsmp_sql; SET @stmt2 = CONCAT(     "CREATE TABLE tmp_channel_lag AS ("     , " SELECT a.ID as channel_id, a.post_title AS channel,"     , " CONVERT(SUBSTR(c.meta_key,11,1), INTEGER) AS day_no,"     , " CONVERT(IFNULL(c.meta_value, '0'), INTEGER) AS influence"  	, " FROM ", table_prefix, "posts a"     , " JOIN ", table_prefix, "postmeta b ON b.post_id = a.ID AND b.meta_key = 'lag_days'"     , " JOIN ", table_prefix, "postmeta c ON c.post_id = a.ID AND SUBSTR(c.meta_key,1,10) = 'influence_'"  	, " WHERE a.post_type = 'vsmp_channel'"     , " AND a.post_status = 'publish' "     , " AND CONVERT(SUBSTR(c.meta_key,11,1), INTEGER) <= CONVERT(b.meta_value, INTEGER)"     , ')' ); PREPARE vsmp_sql FROM @stmt2; EXECUTE vsmp_sql; DEALLOCATE PREPARE vsmp_sql; SET @stmt3 = CONCAT(     "CREATE TABLE tmp_conversion_log AS ("     , " SELECT *"     , " FROM ", table_prefix, "vsmp_conversion_log"     , " WHERE DATE(log_time) BETWEEN"     , " (SELECT from_date FROM tmp_date_range)"     , " AND"     , " (SELECT to_date FROM tmp_date_range)"  	, ")" );      PREPARE vsmp_sql FROM @stmt3; EXECUTE vsmp_sql; DEALLOCATE PREPARE vsmp_sql; SET @stmt4 = CONCAT(     "CREATE TABLE tmp_delivery_event_log AS ("     , " SELECT *"     , " FROM ", table_prefix, "vsmp_delivery_event_log"     , " WHERE DATE(log_time) BETWEEN"     , " (SELECT DATE_SUB(from_date, INTERVAL 14 DAY) FROM tmp_date_range)"     , " AND"     , " (SELECT to_date FROM tmp_date_range)" 	, ")" );      PREPARE vsmp_sql FROM @stmt4; EXECUTE vsmp_sql; DEALLOCATE PREPARE vsmp_sql; CREATE TABLE tmp_delivery_event_influence_01 AS (  SELECT @row_seq := @row_seq + 1 as row_seq, a.conversion_id, a.channel_id, a.delivery_event_id, a.delivery_event_time, a.conversion_time, a.day_no  FROM (   SELECT a1.conversion_id, a3.channel_id, a2.delivery_event_id, a2.log_time AS delivery_event_time, a1.log_time AS conversion_time,    FLOOR(TIMESTAMPDIFF(SECOND, a2.log_time, a1.log_time) / 86400) AS day_no   FROM tmp_conversion_log a1   JOIN tmp_delivery_event_log a2 on a2.vsmp_visitor_Id = a1.vsmp_visitor_Id   JOIN tmp_delivery_event a3 ON a3.delivery_event_Id = a2.delivery_event_Id   JOIN (    SELECT channel_id, MAX(day_no) AS max_day_no    FROM tmp_channel_lag    GROUP BY channel_id   ) a4 ON a4.channel_id = a3.channel_id    WHERE a1.log_time >= a2.log_time - INTERVAL a4.max_day_no DAY   ORDER BY a1.conversion_id, a2.log_time  ) a  CROSS JOIN (   SELECT @row_seq := 0  ) b ); CREATE TABLE tmp_delivery_event_influence_02 AS (  SELECT a.conversion_id, a.channel_id, a.delivery_event_Id, a.day_no, a.delivery_event_time, a.conversion_time, b.path_seq  FROM tmp_delivery_event_influence_01 a    JOIN (   SELECT b1.row_seq, COUNT(*) AS path_seq   FROM tmp_delivery_event_influence_01 b1   JOIN tmp_delivery_event_influence_01 b2 ON b2.conversion_id = b1.conversion_id AND b2.delivery_event_time <= b1.delivery_event_time   GROUP BY b1.row_seq  ) b ON b.row_seq = a.row_seq ); SET @stmt5 = CONCAT( 	"DELETE FROM ", table_prefix, "vsmp_influence"  	, " WHERE conversion_id IN ("   	, " SELECT DISTINCT conversion_id"   	, " FROM tmp_delivery_event_influence_02"  	, ")" ); PREPARE vsmp_sql FROM @stmt5; EXECUTE vsmp_sql; DEALLOCATE PREPARE vsmp_sql; SET @stmt6 = CONCAT(     "INSERT INTO ", table_prefix, "vsmp_influence"     , " (conversion_Id, delivery_event_id, path_seq, influence)"     , " SELECT a.conversion_id, a.delivery_event_id, a.path_seq, b.influence / 100"     , " FROM tmp_delivery_event_influence_02 a"  	, " JOIN tmp_channel_lag b ON b.channel_id = a.channel_id AND b.day_no = a.day_no" ); PREPARE vsmp_sql FROM @stmt6; EXECUTE vsmp_sql; DEALLOCATE PREPARE vsmp_sql; DROP TABLE IF EXISTS tmp_date_range; DROP TABLE IF EXISTS tmp_delivery_event; DROP TABLE IF EXISTS tmp_channel_lag; DROP TABLE IF EXISTS tmp_conversion_log; DROP TABLE IF EXISTS tmp_delivery_event_log; DROP TABLE IF EXISTS tmp_delivery_event_influence_01; DROP TABLE IF EXISTS tmp_delivery_event_influence_02; END</p>
<p>Queries made or created this session were:</p>
<ol>
<li>Executing: BEGIN | (no parameters)</li>
<li>Executing: ROLLBACK | (no parameters)</li>
</ol>
</div>
<div style="clear:both;margin-bottom:2px;border:red dotted thin;" class="error_message" style="border-bottom:dotted blue thin;">
MySQL query not supported. Cause: statement type: "createStatement" > "createProcedure"
</div>
<p>Backtrace:</p>
<pre>#0 /internal/shared/sqlite-database-integration/wp-includes/sqlite-ast/class-wp-sqlite-driver.php(848): WP_SQLite_Driver->new_not_supported_exception('statement type:...')
#1 /internal/shared/sqlite-database-integration/wp-includes/sqlite-ast/class-wp-sqlite-driver.php(669): WP_SQLite_Driver->execute_mysql_query(Object(WP_Parser_Node))
#2 /internal/shared/sqlite-database-integration/wp-includes/sqlite/class-wp-sqlite-db.php(491): WP_SQLite_Driver->query(' CREATE PROCEDU...')
#3 /internal/shared/sqlite-database-integration/wp-includes/sqlite/class-wp-sqlite-db.php(432): WP_SQLite_DB->_do_query(' CREATE PROCEDU...')
#4 /wordpress/wp-content/plugins/marketing-performance/activate/vsmp-run_ddl.php(42): WP_SQLite_DB->query(' CREATE PROCEDU...')
#5 /wordpress/wp-content/plugins/marketing-performance/marketing-performance.php(298): vsmp_run_ddl('vsmp-install.sq...')
#6 /wordpress/wp-includes/class-wp-hook.php(324): vsmp_attribution_activate(false)
#7 /wordpress/wp-includes/class-wp-hook.php(348): WP_Hook->apply_filters('', Array)
#8 /wordpress/wp-includes/plugin.php(517): WP_Hook->do_action(Array)
#9 /wordpress/wp-admin/includes/plugin.php(703): do_action('activate_market...', false)
#10 /internal/eval.php(20): activate_plugin('marketing-perfo...')
#11 {main}</pre>
 for query  CREATE PROCEDURE wp_vsmp_compute_influence (IN `table_prefix` VARCHAR(16)) BEGIN DROP TABLE IF EXISTS tmp_date_range; DROP TABLE IF EXISTS tmp_delivery_event; DROP TABLE IF EXISTS tmp_channel_lag; DROP TABLE IF EXISTS tmp_conversion_log; DROP TABLE IF EXISTS tmp_delivery_event_log; DROP TABLE IF EXISTS tmp_delivery_event_influence_01; DROP TABLE IF EXISTS tmp_delivery_event_influence_02; CREATE TABLE tmp_date_range AS (      SELECT DATE_SUB(CURRENT_DATE, INTERVAL 28 DAY) AS from_date, CURRENT_DATE AS to_date ); SET @stmt1 = CONCAT(     "CREATE TABLE tmp_delivery_event AS ("     , " SELECT a.ID AS delivery_event_Id,"     , " CONVERT(b.meta_value, INTEGER) AS campaign_id,"     , " CONVERT(c.meta_value, INTEGER) AS channel_Id"     , " FROM ", table_prefix, "posts a"     , " JOIN ", table_prefix, "postmeta b ON b.post_id = a.ID AND b.meta_key = 'campaign_id'"  	, " JOIN ", table_prefix, "postmeta c ON c.post_id = a.ID AND c.meta_key = 'channel_id'"     , " WHERE a.post_type = 'vsmp_delivery_event'"     , " AND a.post_status = 'publish'"     , ')' ); PREPARE vsmp_sql FROM @stmt1; EXECUTE vsmp_sql; DEALLOCATE PREPARE vsmp_sql; SET @stmt2 = CONCAT(     "CREATE TABLE tmp_channel_lag AS ("     , " SELECT a.ID as channel_id, a.post_title AS channel,"     , " CONVERT(SUBSTR(c.meta_key,11,1), INTEGER) AS day_no,"     , " CONVERT(IFNULL(c.meta_value, '0'), INTEGER) AS influence"  	, " FROM ", table_prefix, "posts a"     , " JOIN ", table_prefix, "postmeta b ON b.post_id = a.ID AND b.meta_key = 'lag_days'"     , " JOIN ", table_prefix, "postmeta c ON c.post_id = a.ID AND SUBSTR(c.meta_key,1,10) = 'influence_'"  	, " WHERE a.post_type = 'vsmp_channel'"     , " AND a.post_status = 'publish' "     , " AND CONVERT(SUBSTR(c.meta_key,11,1), INTEGER) <= CONVERT(b.meta_value, INTEGER)"     , ')' ); PREPARE vsmp_sql FROM @stmt2; EXECUTE vsmp_sql; DEALLOCATE PREPARE vsmp_sql; SET @stmt3 = CONCAT(     "CREATE TABLE tmp_conversion_log AS ("     , " SELECT *"     , " FROM ", table_prefix, "vsmp_conversion_log"     , " WHERE DATE(log_time) BETWEEN"     , " (SELECT from_date FROM tmp_date_range)"     , " AND"     , " (SELECT to_date FROM tmp_date_range)"  	, ")" );      PREPARE vsmp_sql FROM @stmt3; EXECUTE vsmp_sql; DEALLOCATE PREPARE vsmp_sql; SET @stmt4 = CONCAT(     "CREATE TABLE tmp_delivery_event_log AS ("     , " SELECT *"     , " FROM ", table_prefix, "vsmp_delivery_event_log"     , " WHERE DATE(log_time) BETWEEN"     , " (SELECT DATE_SUB(from_date, INTERVAL 14 DAY) FROM tmp_date_range)"     , " AND"     , " (SELECT to_date FROM tmp_date_range)" 	, ")" );      PREPARE vsmp_sql FROM @stmt4; EXECUTE vsmp_sql; DEALLOCATE PREPARE vsmp_sql; CREATE TABLE tmp_delivery_event_influence_01 AS (  SELECT @row_seq := @row_seq + 1 as row_seq, a.conversion_id, a.channel_id, a.delivery_event_id, a.delivery_event_time, a.conversion_time, a.day_no  FROM (   SELECT a1.conversion_id, a3.channel_id, a2.delivery_event_id, a2.log_time AS delivery_event_time, a1.log_time AS conversion_time,    FLOOR(TIMESTAMPDIFF(SECOND, a2.log_time, a1.log_time) / 86400) AS day_no   FROM tmp_conversion_log a1   JOIN tmp_delivery_event_log a2 on a2.vsmp_visitor_Id = a1.vsmp_visitor_Id   JOIN tmp_delivery_event a3 ON a3.delivery_event_Id = a2.delivery_event_Id   JOIN (    SELECT channel_id, MAX(day_no) AS max_day_no    FROM tmp_channel_lag    GROUP BY channel_id   ) a4 ON a4.channel_id = a3.channel_id    WHERE a1.log_time >= a2.log_time - INTERVAL a4.max_day_no DAY   ORDER BY a1.conversion_id, a2.log_time  ) a  CROSS JOIN (   SELECT @row_seq := 0  ) b ); CREATE TABLE tmp_delivery_event_influence_02 AS (  SELECT a.conversion_id, a.channel_id, a.delivery_event_Id, a.day_no, a.delivery_event_time, a.conversion_time, b.path_seq  FROM tmp_delivery_event_influence_01 a    JOIN (   SELECT b1.row_seq, COUNT(*) AS path_seq   FROM tmp_delivery_event_influence_01 b1   JOIN tmp_delivery_event_influence_01 b2 ON b2.conversion_id = b1.conversion_id AND b2.delivery_event_time <= b1.delivery_event_time   GROUP BY b1.row_seq  ) b ON b.row_seq = a.row_seq ); SET @stmt5 = CONCAT( 	"DELETE FROM ", table_prefix, "vsmp_influence"  	, " WHERE conversion_id IN ("   	, " SELECT DISTINCT conversion_id"   	, " FROM tmp_delivery_event_influence_02"  	, ")" ); PREPARE vsmp_sql FROM @stmt5; EXECUTE vsmp_sql; DEALLOCATE PREPARE vsmp_sql; SET @stmt6 = CONCAT(     "INSERT INTO ", table_prefix, "vsmp_influence"     , " (conversion_Id, delivery_event_id, path_seq, influence)"     , " SELECT a.conversion_id, a.delivery_event_id, a.path_seq, b.influence / 100"     , " FROM tmp_delivery_event_influence_02 a"  	, " JOIN tmp_channel_lag b ON b.channel_id = a.channel_id AND b.day_no = a.day_no" ); PREPARE vsmp_sql FROM @stmt6; EXECUTE vsmp_sql; DEALLOCATE PREPARE vsmp_sql; DROP TABLE IF EXISTS tmp_date_range; DROP TABLE IF EXISTS tmp_delivery_event; DROP TABLE IF EXISTS tmp_channel_lag; DROP TABLE IF EXISTS tmp_conversion_log; DROP TABLE IF EXISTS tmp_delivery_event_log; DROP TABLE IF EXISTS tmp_delivery_event_influence_01; DROP TABLE IF EXISTS tmp_delivery_event_influence_02; END made by activate_plugin, do_action('activate_marketing-performance/marketing-performance.php'), WP_Hook->do_action, WP_Hook->apply_filters, vsmp_attribution_activate, vsmp_run_ddl, WP_SQLite_DB->query, WP_SQLite_DB->print_error
[20-May-2025 15:59:40 UTC] WordPress database error <div style="clear:both">&nbsp;</div>
<div class="queries" style="clear:both;margin-bottom:2px;border:red dotted thin;">
<p>MySQL query:</p>
<p> DROP PROCEDURE IF EXISTS wp_vsmp_compute_path;</p>
<p>Queries made or created this session were:</p>
<ol>
<li>Executing: BEGIN | (no parameters)</li>
<li>Executing: DROP PROCEDURE IF EXISTS `wp_vsmp_compute_path` | (no parameters)</li>
<li>Executing: ROLLBACK | (no parameters)</li>
</ol>
</div>
<div style="clear:both;margin-bottom:2px;border:red dotted thin;" class="error_message" style="border-bottom:dotted blue thin;">
SQLSTATE[HY000]: General error: 1 near "PROCEDURE": syntax error
</div>
<p>Backtrace:</p>
<pre>#0 /internal/shared/sqlite-database-integration/wp-includes/sqlite-ast/class-wp-sqlite-driver.php(683): WP_SQLite_Driver->new_driver_exception('SQLSTATE[HY000]...', 'HY000', Object(PDOException))
#1 /internal/shared/sqlite-database-integration/wp-includes/sqlite/class-wp-sqlite-db.php(491): WP_SQLite_Driver->query(' DROP PROCEDURE...')
#2 /internal/shared/sqlite-database-integration/wp-includes/sqlite/class-wp-sqlite-db.php(432): WP_SQLite_DB->_do_query(' DROP PROCEDURE...')
#3 /wordpress/wp-content/plugins/marketing-performance/activate/vsmp-run_ddl.php(42): WP_SQLite_DB->query(' DROP PROCEDURE...')
#4 /wordpress/wp-content/plugins/marketing-performance/marketing-performance.php(298): vsmp_run_ddl('vsmp-install.sq...')
#5 /wordpress/wp-includes/class-wp-hook.php(324): vsmp_attribution_activate(false)
#6 /wordpress/wp-includes/class-wp-hook.php(348): WP_Hook->apply_filters('', Array)
#7 /wordpress/wp-includes/plugin.php(517): WP_Hook->do_action(Array)
#8 /wordpress/wp-admin/includes/plugin.php(703): do_action('activate_market...', false)
#9 /internal/eval.php(20): activate_plugin('marketing-perfo...')
#10 {main}</pre>
 for query  DROP PROCEDURE IF EXISTS wp_vsmp_compute_path; made by activate_plugin, do_action('activate_marketing-performance/marketing-performance.php'), WP_Hook->do_action, WP_Hook->apply_filters, vsmp_attribution_activate, vsmp_run_ddl, WP_SQLite_DB->query, WP_SQLite_DB->print_error
[20-May-2025 15:59:40 UTC] WordPress database error <div style="clear:both">&nbsp;</div>
<div class="queries" style="clear:both;margin-bottom:2px;border:red dotted thin;">
<p>MySQL query:</p>
<p> CREATE PROCEDURE wp_vsmp_compute_path (IN `table_prefix` VARCHAR(16)) BEGIN DROP TABLE IF EXISTS tmp_date_range; DROP TABLE IF EXISTS tmp_delivery_event; DROP TABLE IF EXISTS tmp_conversion_log; DROP TABLE IF EXISTS tmp_influence; DROP TABLE IF EXISTS tmp_channel_metric_01; DROP TABLE IF EXISTS tmp_channel_metric_02; DROP TABLE IF EXISTS tmp_channel_metric_03; CREATE TABLE tmp_date_range AS (      SELECT DATE_SUB(CURRENT_DATE, INTERVAL 28 DAY) AS from_date, CURRENT_DATE AS to_date ); SET @stmt1 = CONCAT(   "CREATE TABLE tmp_delivery_event AS ("     , " SELECT a.ID AS delivery_event_Id,"     , " CONVERT(b.meta_value, INTEGER) AS campaign_id,"     , " CONVERT(c.meta_value, INTEGER) AS channel_id," 	, " d.post_title AS channel_title"     , " FROM ", table_prefix, "posts a"     , " JOIN ", table_prefix, "postmeta b ON b.post_id = a.ID AND b.meta_key = 'campaign_id'"  	, " JOIN ", table_prefix, "postmeta c ON c.post_id = a.ID AND c.meta_key = 'channel_id'" 	, " JOIN ", table_prefix, "posts d ON d.ID = CONVERT(c.meta_value, INTEGER)"     , " WHERE a.post_type = 'vsmp_delivery_event'"     , " AND a.post_status = 'publish'"     , ')' ); PREPARE vsmp_sql FROM @stmt1; EXECUTE vsmp_sql; DEALLOCATE PREPARE vsmp_sql; SET @stmt2 = CONCAT(     "CREATE TABLE tmp_conversion_log AS ("     , " SELECT conversion_id, DATE(log_time) AS cal_date"     , " FROM ", table_prefix, "vsmp_conversion_log"     , " WHERE DATE(log_time) BETWEEN"     , " (SELECT from_date FROM tmp_date_range)"     , " AND"     , " (SELECT to_date FROM tmp_date_range)"  	, ")" );      PREPARE vsmp_sql FROM @stmt2; EXECUTE vsmp_sql; DEALLOCATE PREPARE vsmp_sql; SET @stmt3 = CONCAT(   "CREATE TABLE tmp_influence AS ("     , " SELECT *"     , " FROM ", table_prefix, "vsmp_influence"     , " WHERE conversion_id IN ("     , " SELECT conversion_id"     , " FROM tmp_conversion_log"     , ")"     , ")" ); PREPARE vsmp_sql FROM @stmt3; EXECUTE vsmp_sql; DEALLOCATE PREPARE vsmp_sql; SET @stmt4 = CONCAT(     "DELETE FROM ", table_prefix, "vsmp_channel_metric"     , " WHERE cal_date BETWEEN"     , " (SELECT from_date FROM tmp_date_range)"     , " AND"     , " (SELECT to_date FROM tmp_date_range)" ); PREPARE vsmp_sql FROM @stmt4; EXECUTE vsmp_sql; DEALLOCATE PREPARE vsmp_sql; SET @stmt5 = CONCAT(     "CREATE TABLE tmp_channel_metric_01 AS (" 	, " SELECT b.cal_date,"     , " TRIM(a.metric_detail) AS metric_detail,"     , " a.channel_count,"     , " COUNT(*) AS metric_count"     , " FROM (" 	, " SELECT a1.conversion_id,"     , " GROUP_CONCAT(a1.channel_title ORDER BY a1.channel_title SEPARATOR ';') AS metric_detail,"     , " COUNT(*) AS channel_count" 	, " FROM (" 	, " SELECT DISTINCT a1a.conversion_id, a1b.channel_title" 	, " FROM tmp_influence a1a" 	, " JOIN tmp_delivery_event a1b ON a1b.delivery_event_id = a1a.delivery_event_id"     , " ) a1" 	, " GROUP BY a1.conversion_id"     , " ) a"     , " JOIN tmp_conversion_log b ON b.conversion_id = a.conversion_id"     , " GROUP BY 1, 2"     , ")" ); PREPARE vsmp_sql FROM @stmt5; EXECUTE vsmp_sql; DEALLOCATE PREPARE vsmp_sql; SET @stmt6 = CONCAT(     "INSERT INTO ", table_prefix, "vsmp_channel_metric" 	, " (cal_date, metric_type, metric_detail, metric_count)"     , " SELECT cal_date, 'channels', metric_detail, metric_count"     , " FROM tmp_channel_metric_01" ); PREPARE vsmp_sql FROM @stmt6; EXECUTE vsmp_sql; DEALLOCATE PREPARE vsmp_sql; SET @stmt7 = CONCAT(     "CREATE TABLE tmp_channel_metric_02 AS (" 	, " SELECT b.cal_date, c.channel_title, COUNT(*) AS metric_count"     , " FROM wp_vsmp_influence a"     , " JOIN tmp_conversion_log b ON b.conversion_id = a.conversion_id"     , " JOIN tmp_delivery_event c ON c.delivery_event_Id = a.delivery_event_id"     , " WHERE a.path_seq = 1"     , " GROUP BY 1, 2"     , " )" ); PREPARE vsmp_sql FROM @stmt7; EXECUTE vsmp_sql; DEALLOCATE PREPARE vsmp_sql; SET @stmt8 = CONCAT(     "INSERT INTO ", table_prefix, "vsmp_channel_metric" 	, " (cal_date, metric_type, metric_detail, metric_count)"     , " SELECT cal_date, 'starter', channel_title, metric_count"     , " FROM tmp_channel_metric_02" ); PREPARE vsmp_sql FROM @stmt8; EXECUTE vsmp_sql; DEALLOCATE PREPARE vsmp_sql; SET @stmt9 = CONCAT(     "CREATE TABLE tmp_channel_metric_03 AS ("     , " SELECT b.cal_date, c.channel_title, COUNT(*) AS metric_count"     , " FROM tmp_influence a"      , " JOIN tmp_conversion_log b ON b.conversion_id = a.conversion_id"     , " JOIN tmp_delivery_event c ON c.delivery_event_Id = a.delivery_event_id"     , " JOIN ("     , " SELECT conversion_id, MAX(path_seq) AS max_path_seq"     , " FROM tmp_influence"     , " GROUP BY conversion_id"     , " ) d ON d.conversion_id = a.conversion_id AND d.max_path_seq = a.path_seq"      , " GROUP BY 1, 2"     , ")" ); PREPARE vsmp_sql FROM @stmt9; EXECUTE vsmp_sql; DEALLOCATE PREPARE vsmp_sql; SET @stmt10 = CONCAT(     "INSERT INTO ", table_prefix, "vsmp_channel_metric" 	, " (cal_date, metric_type, metric_detail, metric_count)"     , " SELECT cal_date, 'closer', channel_title, metric_count"     , " FROM tmp_channel_metric_03" ); PREPARE vsmp_sql FROM @stmt10; EXECUTE vsmp_sql; DEALLOCATE PREPARE vsmp_sql; DROP TABLE IF EXISTS tmp_date_range; DROP TABLE IF EXISTS tmp_delivery_event; DROP TABLE IF EXISTS tmp_conversion_log; DROP TABLE IF EXISTS tmp_influence; DROP TABLE IF EXISTS tmp_channel_metric_01; DROP TABLE IF EXISTS tmp_channel_metric_02; DROP TABLE IF EXISTS tmp_channel_metric_03; END</p>
<p>Queries made or created this session were:</p>
<ol>
<li>Executing: BEGIN | (no parameters)</li>
<li>Executing: ROLLBACK | (no parameters)</li>
</ol>
</div>
<div style="clear:both;margin-bottom:2px;border:red dotted thin;" class="error_message" style="border-bottom:dotted blue thin;">
MySQL query not supported. Cause: statement type: "createStatement" > "createProcedure"
</div>
<p>Backtrace:</p>
<pre>#0 /internal/shared/sqlite-database-integration/wp-includes/sqlite-ast/class-wp-sqlite-driver.php(848): WP_SQLite_Driver->new_not_supported_exception('statement type:...')
#1 /internal/shared/sqlite-database-integration/wp-includes/sqlite-ast/class-wp-sqlite-driver.php(669): WP_SQLite_Driver->execute_mysql_query(Object(WP_Parser_Node))
#2 /internal/shared/sqlite-database-integration/wp-includes/sqlite/class-wp-sqlite-db.php(491): WP_SQLite_Driver->query(' CREATE PROCEDU...')
#3 /internal/shared/sqlite-database-integration/wp-includes/sqlite/class-wp-sqlite-db.php(432): WP_SQLite_DB->_do_query(' CREATE PROCEDU...')
#4 /wordpress/wp-content/plugins/marketing-performance/activate/vsmp-run_ddl.php(42): WP_SQLite_DB->query(' CREATE PROCEDU...')
#5 /wordpress/wp-content/plugins/marketing-performance/marketing-performance.php(298): vsmp_run_ddl('vsmp-install.sq...')
#6 /wordpress/wp-includes/class-wp-hook.php(324): vsmp_attribution_activate(false)
#7 /wordpress/wp-includes/class-wp-hook.php(348): WP_Hook->apply_filters('', Array)
#8 /wordpress/wp-includes/plugin.php(517): WP_Hook->do_action(Array)
#9 /wordpress/wp-admin/includes/plugin.php(703): do_action('activate_market...', false)
#10 /internal/eval.php(20): activate_plugin('marketing-perfo...')
#11 {main}</pre>
 for query  CREATE PROCEDURE wp_vsmp_compute_path (IN `table_prefix` VARCHAR(16)) BEGIN DROP TABLE IF EXISTS tmp_date_range; DROP TABLE IF EXISTS tmp_delivery_event; DROP TABLE IF EXISTS tmp_conversion_log; DROP TABLE IF EXISTS tmp_influence; DROP TABLE IF EXISTS tmp_channel_metric_01; DROP TABLE IF EXISTS tmp_channel_metric_02; DROP TABLE IF EXISTS tmp_channel_metric_03; CREATE TABLE tmp_date_range AS (      SELECT DATE_SUB(CURRENT_DATE, INTERVAL 28 DAY) AS from_date, CURRENT_DATE AS to_date ); SET @stmt1 = CONCAT(   "CREATE TABLE tmp_delivery_event AS ("     , " SELECT a.ID AS delivery_event_Id,"     , " CONVERT(b.meta_value, INTEGER) AS campaign_id,"     , " CONVERT(c.meta_value, INTEGER) AS channel_id," 	, " d.post_title AS channel_title"     , " FROM ", table_prefix, "posts a"     , " JOIN ", table_prefix, "postmeta b ON b.post_id = a.ID AND b.meta_key = 'campaign_id'"  	, " JOIN ", table_prefix, "postmeta c ON c.post_id = a.ID AND c.meta_key = 'channel_id'" 	, " JOIN ", table_prefix, "posts d ON d.ID = CONVERT(c.meta_value, INTEGER)"     , " WHERE a.post_type = 'vsmp_delivery_event'"     , " AND a.post_status = 'publish'"     , ')' ); PREPARE vsmp_sql FROM @stmt1; EXECUTE vsmp_sql; DEALLOCATE PREPARE vsmp_sql; SET @stmt2 = CONCAT(     "CREATE TABLE tmp_conversion_log AS ("     , " SELECT conversion_id, DATE(log_time) AS cal_date"     , " FROM ", table_prefix, "vsmp_conversion_log"     , " WHERE DATE(log_time) BETWEEN"     , " (SELECT from_date FROM tmp_date_range)"     , " AND"     , " (SELECT to_date FROM tmp_date_range)"  	, ")" );      PREPARE vsmp_sql FROM @stmt2; EXECUTE vsmp_sql; DEALLOCATE PREPARE vsmp_sql; SET @stmt3 = CONCAT(   "CREATE TABLE tmp_influence AS ("     , " SELECT *"     , " FROM ", table_prefix, "vsmp_influence"     , " WHERE conversion_id IN ("     , " SELECT conversion_id"     , " FROM tmp_conversion_log"     , ")"     , ")" ); PREPARE vsmp_sql FROM @stmt3; EXECUTE vsmp_sql; DEALLOCATE PREPARE vsmp_sql; SET @stmt4 = CONCAT(     "DELETE FROM ", table_prefix, "vsmp_channel_metric"     , " WHERE cal_date BETWEEN"     , " (SELECT from_date FROM tmp_date_range)"     , " AND"     , " (SELECT to_date FROM tmp_date_range)" ); PREPARE vsmp_sql FROM @stmt4; EXECUTE vsmp_sql; DEALLOCATE PREPARE vsmp_sql; SET @stmt5 = CONCAT(     "CREATE TABLE tmp_channel_metric_01 AS (" 	, " SELECT b.cal_date,"     , " TRIM(a.metric_detail) AS metric_detail,"     , " a.channel_count,"     , " COUNT(*) AS metric_count"     , " FROM (" 	, " SELECT a1.conversion_id,"     , " GROUP_CONCAT(a1.channel_title ORDER BY a1.channel_title SEPARATOR ';') AS metric_detail,"     , " COUNT(*) AS channel_count" 	, " FROM (" 	, " SELECT DISTINCT a1a.conversion_id, a1b.channel_title" 	, " FROM tmp_influence a1a" 	, " JOIN tmp_delivery_event a1b ON a1b.delivery_event_id = a1a.delivery_event_id"     , " ) a1" 	, " GROUP BY a1.conversion_id"     , " ) a"     , " JOIN tmp_conversion_log b ON b.conversion_id = a.conversion_id"     , " GROUP BY 1, 2"     , ")" ); PREPARE vsmp_sql FROM @stmt5; EXECUTE vsmp_sql; DEALLOCATE PREPARE vsmp_sql; SET @stmt6 = CONCAT(     "INSERT INTO ", table_prefix, "vsmp_channel_metric" 	, " (cal_date, metric_type, metric_detail, metric_count)"     , " SELECT cal_date, 'channels', metric_detail, metric_count"     , " FROM tmp_channel_metric_01" ); PREPARE vsmp_sql FROM @stmt6; EXECUTE vsmp_sql; DEALLOCATE PREPARE vsmp_sql; SET @stmt7 = CONCAT(     "CREATE TABLE tmp_channel_metric_02 AS (" 	, " SELECT b.cal_date, c.channel_title, COUNT(*) AS metric_count"     , " FROM wp_vsmp_influence a"     , " JOIN tmp_conversion_log b ON b.conversion_id = a.conversion_id"     , " JOIN tmp_delivery_event c ON c.delivery_event_Id = a.delivery_event_id"     , " WHERE a.path_seq = 1"     , " GROUP BY 1, 2"     , " )" ); PREPARE vsmp_sql FROM @stmt7; EXECUTE vsmp_sql; DEALLOCATE PREPARE vsmp_sql; SET @stmt8 = CONCAT(     "INSERT INTO ", table_prefix, "vsmp_channel_metric" 	, " (cal_date, metric_type, metric_detail, metric_count)"     , " SELECT cal_date, 'starter', channel_title, metric_count"     , " FROM tmp_channel_metric_02" ); PREPARE vsmp_sql FROM @stmt8; EXECUTE vsmp_sql; DEALLOCATE PREPARE vsmp_sql; SET @stmt9 = CONCAT(     "CREATE TABLE tmp_channel_metric_03 AS ("     , " SELECT b.cal_date, c.channel_title, COUNT(*) AS metric_count"     , " FROM tmp_influence a"      , " JOIN tmp_conversion_log b ON b.conversion_id = a.conversion_id"     , " JOIN tmp_delivery_event c ON c.delivery_event_Id = a.delivery_event_id"     , " JOIN ("     , " SELECT conversion_id, MAX(path_seq) AS max_path_seq"     , " FROM tmp_influence"     , " GROUP BY conversion_id"     , " ) d ON d.conversion_id = a.conversion_id AND d.max_path_seq = a.path_seq"      , " GROUP BY 1, 2"     , ")" ); PREPARE vsmp_sql FROM @stmt9; EXECUTE vsmp_sql; DEALLOCATE PREPARE vsmp_sql; SET @stmt10 = CONCAT(     "INSERT INTO ", table_prefix, "vsmp_channel_metric" 	, " (cal_date, metric_type, metric_detail, metric_count)"     , " SELECT cal_date, 'closer', channel_title, metric_count"     , " FROM tmp_channel_metric_03" ); PREPARE vsmp_sql FROM @stmt10; EXECUTE vsmp_sql; DEALLOCATE PREPARE vsmp_sql; DROP TABLE IF EXISTS tmp_date_range; DROP TABLE IF EXISTS tmp_delivery_event; DROP TABLE IF EXISTS tmp_conversion_log; DROP TABLE IF EXISTS tmp_influence; DROP TABLE IF EXISTS tmp_channel_metric_01; DROP TABLE IF EXISTS tmp_channel_metric_02; DROP TABLE IF EXISTS tmp_channel_metric_03; END made by activate_plugin, do_action('activate_marketing-performance/marketing-performance.php'), WP_Hook->do_action, WP_Hook->apply_filters, vsmp_attribution_activate, vsmp_run_ddl, WP_SQLite_DB->query, WP_SQLite_DB->print_error
[20-May-2025 15:59:40 UTC] WordPress database error <div style="clear:both">&nbsp;</div>
<div class="queries" style="clear:both;margin-bottom:2px;border:red dotted thin;">
<p>MySQL query:</p>
<p> CREATE PROCEDURE wp_vsmp_compute_commission (IN `table_prefix` VARCHAR(16)) BEGIN CREATE OR REPLACE TABLE tmp_date_range AS (  SELECT DATE_SUB(CURRENT_DATE, INTERVAL 28 DAY) AS from_date, CURRENT_DATE AS to_date ); SET @stmt1 = CONCAT(  "CREATE OR REPLACE TABLE tmp_conversion_log AS"   , " SELECT *"  , " FROM ", table_prefix, "vsmp_conversion_log"   , " WHERE DATE(log_time) BETWEEN"     , " (SELECT from_date FROM tmp_date_range)"   , " AND"    , " (SELECT to_date FROM tmp_date_range)"  ); PREPARE vsmp_sql FROM @stmt1; EXECUTE vsmp_sql; DEALLOCATE PREPARE vsmp_sql; SET @stmt2 = CONCAT(  "CREATE OR REPLACE TABLE tmp_delivery_event AS "  , " SELECT a.ID AS delivery_event_Id,"     , " CONVERT(b.meta_value, INTEGER) AS campaign_id,"   , " CONVERT(c.meta_value, INTEGER) AS channel_Id,"  , " CONVERT(d.meta_value, INTEGER) AS commission_days,"  , " CAST(e.meta_value AS DECIMAL(5,2)) AS commission_pct"   , " FROM ", table_prefix, "posts a"    , " JOIN ", table_prefix, "postmeta b ON b.post_id = a.ID AND b.meta_key = 'campaign_id'"   , " JOIN ", table_prefix, "postmeta c ON c.post_id = a.ID AND c.meta_key = 'channel_id'"  , " JOIN ", table_prefix, "postmeta d ON d.post_id = a.ID AND d.meta_key = 'commission_days' AND d.meta_key IS NOT NULL"  , " JOIN ", table_prefix, "postmeta e ON e.post_id = a.ID AND e.meta_key = 'commission_pct' AND e.meta_key IS NOT NULL"  , " WHERE a.post_type = 'vsmp_delivery_event'"    , " AND a.post_status = 'publish'" ); PREPARE vsmp_sql FROM @stmt2; EXECUTE vsmp_sql; DEALLOCATE PREPARE vsmp_sql; SET @stmt3 = CONCAT(  "CREATE OR REPLACE TABLE tmp_delivery_event_log AS"      , " SELECT *"     , " FROM ", table_prefix, "vsmp_delivery_event_log"   , " WHERE DATE(log_time) BETWEEN"  , " (SELECT DATE_SUB(from_date, INTERVAL max_commission_days DAY)"  , " FROM tmp_date_range f1"  , " CROSS JOIN ("  , " SELECT MAX(commission_days) as max_commission_days"  , " FROM tmp_delivery_event"  , " ) f2"  , " )"   , " AND"     , " (SELECT to_date FROM tmp_date_range)"  , " AND delivery_event_id IN"  , " (SELECT delivery_event_id FROM tmp_delivery_event)" ); PREPARE vsmp_sql FROM @stmt3; EXECUTE vsmp_sql; DEALLOCATE PREPARE vsmp_sql; SET @stmt4 = CONCAT(  "DELETE FROM ", table_prefix, "vsmp_commission"  , " WHERE conversion_id IN ("  , " SELECT conversion_id"  , " FROM tmp_conversion_log"  , " )" ); PREPARE vsmp_sql FROM @stmt4; EXECUTE vsmp_sql; DEALLOCATE PREPARE vsmp_sql; SET @stmt5 = CONCAT(  "INSERT INTO ", table_prefix, "vsmp_commission"  , " (conversion_id, conversion_date, conversion_val, delivery_event_id, commission_pct, commission)"  , " SELECT DISTINCT a.conversion_id, DATE(a.log_time), a.conversion_val, b.delivery_event_id, c.commission_pct,"  , " a.conversion_val * c.commission_pct / 100"  , " FROM tmp_conversion_log a"  , " JOiN tmp_delivery_event_log b on b.vsmp_visitor_id = a.vsmp_visitor_id"  , " JOIN tmp_delivery_event c on c.delivery_event_Id = b.delivery_event_id"  , " WHERE b.log_time BETWEEN DATE_SUB(a.log_time, INTERVAL c.commission_days DAY) AND a.log_time" ); PREPARE vsmp_sql FROM @stmt5; EXECUTE vsmp_sql; DEALLOCATE PREPARE vsmp_sql; DROP TABLE IF EXISTS tmp_date_range; DROP TABLE IF EXISTS tmp_conversion_log; DROP TABLE IF EXISTS tmp_delivery_event; DROP TABLE IF EXISTS tmp_delivery_event_log; END</p>
<p>Queries made or created this session were:</p>
<ol>
</ol>
</div>
<div style="clear:both;margin-bottom:2px;border:red dotted thin;" class="error_message" style="border-bottom:dotted blue thin;">
Failed to parse the MySQL query.
</div>
<p>Backtrace:</p>
<pre>#0 /internal/shared/sqlite-database-integration/wp-includes/sqlite-ast/class-wp-sqlite-driver.php(606): WP_SQLite_Driver->new_driver_exception('Failed to parse...')
#1 /internal/shared/sqlite-database-integration/wp-includes/sqlite/class-wp-sqlite-db.php(491): WP_SQLite_Driver->query(' CREATE PROCEDU...')
#2 /internal/shared/sqlite-database-integration/wp-includes/sqlite/class-wp-sqlite-db.php(432): WP_SQLite_DB->_do_query(' CREATE PROCEDU...')
#3 /wordpress/wp-content/plugins/marketing-performance/activate/vsmp-run_ddl.php(42): WP_SQLite_DB->query(' CREATE PROCEDU...')
#4 /wordpress/wp-content/plugins/marketing-performance/marketing-performance.php(298): vsmp_run_ddl('vsmp-install.sq...')
#5 /wordpress/wp-includes/class-wp-hook.php(324): vsmp_attribution_activate(false)
#6 /wordpress/wp-includes/class-wp-hook.php(348): WP_Hook->apply_filters('', Array)
#7 /wordpress/wp-includes/plugin.php(517): WP_Hook->do_action(Array)
#8 /wordpress/wp-admin/includes/plugin.php(703): do_action('activate_market...', false)
#9 /internal/eval.php(20): activate_plugin('marketing-perfo...')
#10 {main}</pre>
 for query  CREATE PROCEDURE wp_vsmp_compute_commission (IN `table_prefix` VARCHAR(16)) BEGIN CREATE OR REPLACE TABLE tmp_date_range AS (  SELECT DATE_SUB(CURRENT_DATE, INTERVAL 28 DAY) AS from_date, CURRENT_DATE AS to_date ); SET @stmt1 = CONCAT(  "CREATE OR REPLACE TABLE tmp_conversion_log AS"   , " SELECT *"  , " FROM ", table_prefix, "vsmp_conversion_log"   , " WHERE DATE(log_time) BETWEEN"     , " (SELECT from_date FROM tmp_date_range)"   , " AND"    , " (SELECT to_date FROM tmp_date_range)"  ); PREPARE vsmp_sql FROM @stmt1; EXECUTE vsmp_sql; DEALLOCATE PREPARE vsmp_sql; SET @stmt2 = CONCAT(  "CREATE OR REPLACE TABLE tmp_delivery_event AS "  , " SELECT a.ID AS delivery_event_Id,"     , " CONVERT(b.meta_value, INTEGER) AS campaign_id,"   , " CONVERT(c.meta_value, INTEGER) AS channel_Id,"  , " CONVERT(d.meta_value, INTEGER) AS commission_days,"  , " CAST(e.meta_value AS DECIMAL(5,2)) AS commission_pct"   , " FROM ", table_prefix, "posts a"    , " JOIN ", table_prefix, "postmeta b ON b.post_id = a.ID AND b.meta_key = 'campaign_id'"   , " JOIN ", table_prefix, "postmeta c ON c.post_id = a.ID AND c.meta_key = 'channel_id'"  , " JOIN ", table_prefix, "postmeta d ON d.post_id = a.ID AND d.meta_key = 'commission_days' AND d.meta_key IS NOT NULL"  , " JOIN ", table_prefix, "postmeta e ON e.post_id = a.ID AND e.meta_key = 'commission_pct' AND e.meta_key IS NOT NULL"  , " WHERE a.post_type = 'vsmp_delivery_event'"    , " AND a.post_status = 'publish'" ); PREPARE vsmp_sql FROM @stmt2; EXECUTE vsmp_sql; DEALLOCATE PREPARE vsmp_sql; SET @stmt3 = CONCAT(  "CREATE OR REPLACE TABLE tmp_delivery_event_log AS"      , " SELECT *"     , " FROM ", table_prefix, "vsmp_delivery_event_log"   , " WHERE DATE(log_time) BETWEEN"  , " (SELECT DATE_SUB(from_date, INTERVAL max_commission_days DAY)"  , " FROM tmp_date_range f1"  , " CROSS JOIN ("  , " SELECT MAX(commission_days) as max_commission_days"  , " FROM tmp_delivery_event"  , " ) f2"  , " )"   , " AND"     , " (SELECT to_date FROM tmp_date_range)"  , " AND delivery_event_id IN"  , " (SELECT delivery_event_id FROM tmp_delivery_event)" ); PREPARE vsmp_sql FROM @stmt3; EXECUTE vsmp_sql; DEALLOCATE PREPARE vsmp_sql; SET @stmt4 = CONCAT(  "DELETE FROM ", table_prefix, "vsmp_commission"  , " WHERE conversion_id IN ("  , " SELECT conversion_id"  , " FROM tmp_conversion_log"  , " )" ); PREPARE vsmp_sql FROM @stmt4; EXECUTE vsmp_sql; DEALLOCATE PREPARE vsmp_sql; SET @stmt5 = CONCAT(  "INSERT INTO ", table_prefix, "vsmp_commission"  , " (conversion_id, conversion_date, conversion_val, delivery_event_id, commission_pct, commission)"  , " SELECT DISTINCT a.conversion_id, DATE(a.log_time), a.conversion_val, b.delivery_event_id, c.commission_pct,"  , " a.conversion_val * c.commission_pct / 100"  , " FROM tmp_conversion_log a"  , " JOiN tmp_delivery_event_log b on b.vsmp_visitor_id = a.vsmp_visitor_id"  , " JOIN tmp_delivery_event c on c.delivery_event_Id = b.delivery_event_id"  , " WHERE b.log_time BETWEEN DATE_SUB(a.log_time, INTERVAL c.comm
Node.js v23.11.0
